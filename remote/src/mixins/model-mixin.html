<script>

	const ModelMixin = subclass => class extends subclass {

		static get config() {
			// properties, observers meta data
			return {
				properties: {
					defaultInterval : { // Time in minute of the conference
						type: Number, 
						value: 60
					},
					limitAlert : { // time before the end where we have to alert the speaker (if defaultInterval is upper limitAlert)
						type: Number,
						value: 1
					},
					totalTime : { // Total time ellapsed during the presentation
						type: Number, 
						value: 0 
					},
					socket : Object, // The webSocket
					localUrl : String, // var in order to see if the presentation has already be loaded    
					currentPluginActiv : String, // The id of the currentPlugin
					indicesDist : { // Basic initialization for presentation on client side
						type: Object,
						value: () => {return {h:0, v:0};}						
					}, 
					indices : { // Basic initialization of indices of engine presentation
						type: Object,
						value: () => {return {h:0, v:0};}						
					}, 
					currentSlideNumber : { // current slide number on client side
						type: Number,
						value: 1
					},
					nextSlideNumber : { // next slide number on preview 
						type: Number,
						value: 1
					},
					nbSlides : { // Total Number of slides        
						type: Number,
						value: 0
					},
					mapPosition : { // The position of slide according to indexs
						type: Object,
						value: () => {return {};}
					},
					conf : { // Configuration corresponding to server
						type: Object,
						value: () => {return {};}
					},
					pluginList : { // List of plugin of application
						type: Array,
						value: () => {return [];}
					},
					contentNotes : { // The speaker notes of the current slide
						type: String,
						value: ''
					}
				}
			};
		}

		connectedCallback() {
			super.connectedCallback();
			// If the configuration is passed through the url, we get it, else if have to ask for a qrcode to complete it
			const port = this._getAllUrlParams().port;
			if (port){
				this.conf.port = port;
			}else{
				// Todo
			}
			
		}

		_getAllUrlParams(url) {

			// get query string from url (optional) or window
			var queryString = url ? url.split('?')[1] : window.location.search.slice(1);

			// we'll store the parameters here
			var obj = {};

			// if query string exists
			if (queryString) {

			// stuff after # is not part of query string, so get rid of it
			queryString = queryString.split('#')[0];

			// split our query string into its component parts
			var arr = queryString.split('&');

			for (var i=0; i<arr.length; i++) {
				// separate the keys and the values
				var a = arr[i].split('=');

				// in case params look like: list[]=thing1&list[]=thing2
				var paramNum = undefined;
				var paramName = a[0].replace(/\[\d*\]/, function(v) {
				paramNum = v.slice(1,-1);
				return '';
				});

				// set parameter value (use 'true' if empty)
				var paramValue = typeof(a[1])==='undefined' ? true : a[1];

				// (optional) keep case consistent
				paramName = paramName.toLowerCase();
				paramValue = paramValue.toLowerCase();

				// if parameter name already exists
				if (obj[paramName]) {
				// convert value to array (if still string)
				if (typeof obj[paramName] === 'string') {
					obj[paramName] = [obj[paramName]];
				}
				// if no array index number specified...
				if (typeof paramNum === 'undefined') {
					// put the value on the end of the array
					obj[paramName].push(paramValue);
				}
				// if array index number specified...
				else {
					// put the value at that index number
					obj[paramName][paramNum] = paramValue;
				}
				}
				// if param name doesn't exist yet, set it
				else {
				obj[paramName] = paramValue;
				}
			}
			}

			return obj;
		}


	};

</script>