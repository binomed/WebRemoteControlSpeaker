<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/font-roboto/roboto.html">
<link rel="import" href="../bower_components/app-layout/app-layout.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../mixins/app/app-aggregate-mixin.html">
<link rel="import" href="remote-header.html">
<link rel="import" href="speaker-notes.html">
<link rel="import" href="screen-preview.html">
<link rel="import" href="drawer-left.html">
<link rel="import" href="drawer-right.html">

<dom-module id="remote-app">
	<template>

		<!-- Styles MUST be inside template -->
		<style >

		:host {
			display: block;
			position: relative;
			overflow: hidden;
			width: 100%;
			height: 100%;
		}

		.content{
			display: flex;
			flex-direction: column;
			align-items: stretch;
			align-content: stretch;
			width: 100%;
			height: 100%;
		}

		speaker-notes, screen-preview{
			flex-grow:1;
			margin-top:10px;
			margin-bottom: 10px;
		}


		.content.expand screen-preview{
			display: none;
		}


	</style>



<div class="content" id="contentRemote">
	<remote-header id="header"
			on-dispatch-action="reduceAction"
			running-timer="[[runningTimer]]"
			total-time="[[totalTime]]"></remote-header>
	<speaker-notes
			on-dispatch-action="reduceAction"
			current-slide-number="[[currentSlideNumber]]"
			nb-slides="[[nbSlides]]"
			content-notes="[[contentNotes]]"></speaker-notes>
	<screen-preview
			on-dispatch-action="reduceAction"
			next-slide-number="[[nextSlideNumber]]"
			nb-slides="[[nbSlides]]"
			local-url="[[localUrl]]"></screen-preview>
</div>

<drawer-left id="drawerLeft"
	on-dispatch-action="reduceAction"
	default-interval="[[defaultInterval]]"></drawer-left>
<drawer-right id="drawerRight"></drawer-right>

</template>

<script>

	// Extend Polymer.Element base class
	class RemoteApp extends AppAgregateMixin(Polymer.Element) {

		static get is() { return 'remote-app' }

		static get config() {
			// properties, observers meta data
			return {
				properties: {
				}
			};
		}


		connectedCallback() {
			super.connectedCallback();

		}


		_dispatchUiAction(type,data){
			switch(type){
				case 'toggle-drawer':
					this._toggleDrawer(data);
				break;
				case 'expand-notes':
					this._expandNotes(data);
				break;
			}
		}

		_expandNotes(eventData){
			if (eventData.expand){
				this.$.contentRemote.classList.add('expand');
			}else {
				this.$.contentRemote.classList.remove('expand');
			}
		}

		_toggleDrawer(eventData) {
			switch (eventData.direction) {
				case 'left':
					this.$.drawerLeft.toggleDrawer();
					break;
				case 'right':
					this.$.drawerRight.toggleDrawer();
					this._toggleRightDrawer();
					break;
			}
		}

		/**
		 * Socket Method Overides
		 */
		_presentationMessage(json){
			// Broadcoast message
			super._presentationMessage(json);
		}


	}

	// Register custom element definition using standard platform API
	customElements.define(RemoteApp.is, RemoteApp);

</script>
</dom-module>